<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" viewBox="-1433.5 818.5 1170 655.884" width="1170" height="655.884">
  <defs>
    <font-face font-family="Helvetica Neue" font-size="16" panose-1="2 0 5 3 0 0 0 2 0 4" units-per-em="1000" underline-position="-100" underline-thickness="50" slope="0" x-height="517" cap-height="714" ascent="951.9958" descent="-212.99744" font-weight="400">
      <font-face-src>
        <font-face-name name="HelveticaNeue"/>
      </font-face-src>
    </font-face>
    <font-face font-family="Helvetica Neue" font-size="22" panose-1="2 0 5 3 0 0 0 2 0 4" units-per-em="1000" underline-position="-100" underline-thickness="50" slope="0" x-height="517" cap-height="714" ascent="951.9958" descent="-212.99744" font-weight="400">
      <font-face-src>
        <font-face-name name="HelveticaNeue"/>
      </font-face-src>
    </font-face>
    <marker orient="auto" overflow="visible" markerUnits="strokeWidth" id="FilledArrow_Marker" stroke-linejoin="miter" stroke-miterlimit="10" viewBox="-9 -4 10 8" markerWidth="10" markerHeight="8" color="black">
      <g>
        <path d="M -8 0 L 0 3 L 0 -3 Z" fill="currentColor" stroke="currentColor" stroke-width="1"/>
      </g>
    </marker>
    <font-face font-family="PingFang SC" font-size="12" panose-1="2 11 4 0 0 0 0 0 0 0" units-per-em="1000" underline-position="-150" underline-thickness="58" slope="0" x-height="600" cap-height="860" ascent="1060.0021" descent="-340.0007" font-weight="400">
      <font-face-src>
        <font-face-name name="PingFangSC-Regular"/>
      </font-face-src>
    </font-face>
    <font-face font-family="PingFang SC" font-size="16" panose-1="2 11 4 0 0 0 0 0 0 0" units-per-em="1000" underline-position="-150" underline-thickness="58" slope="0" x-height="600" cap-height="860" ascent="1060.0021" descent="-340.0007" font-weight="400">
      <font-face-src>
        <font-face-name name="PingFangSC-Regular"/>
      </font-face-src>
    </font-face>
    <marker orient="auto" overflow="visible" markerUnits="strokeWidth" id="FilledArrow_Marker_2" stroke-linejoin="miter" stroke-miterlimit="10" viewBox="-1 -4 10 8" markerWidth="10" markerHeight="8" color="black">
      <g>
        <path d="M 8 0 L 0 -3 L 0 3 Z" fill="currentColor" stroke="currentColor" stroke-width="1"/>
      </g>
    </marker>
    <filter id="Shadow" filterUnits="userSpaceOnUse" x="-1433.5" y="818.5">
      <feGaussianBlur in="SourceAlpha" result="blur" stdDeviation="1.3030978"/>
      <feOffset in="blur" result="offset" dx="0" dy="2"/>
      <feFlood flood-color="black" flood-opacity=".2" result="flood"/>
      <feComposite in="flood" in2="offset" operator="in" result="color"/>
      <feMerge>
        <feMergeNode in="color"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
    <font-face font-family="Helvetica" font-size="12" units-per-em="1000" underline-position="-75.68359" underline-thickness="49.316406" slope="0" x-height="522.9492" cap-height="717.28516" ascent="770.0195" descent="-229.98047" font-weight="400">
      <font-face-src>
        <font-face-name name="Helvetica"/>
      </font-face-src>
    </font-face>
    <font-face font-family="Helvetica Neue" font-size="12" panose-1="2 0 5 3 0 0 0 2 0 4" units-per-em="1000" underline-position="-100" underline-thickness="50" slope="0" x-height="517" cap-height="714" ascent="951.9958" descent="-212.99744" font-weight="400">
      <font-face-src>
        <font-face-name name="HelveticaNeue"/>
      </font-face-src>
    </font-face>
  </defs>
  <metadata> Produced by OmniGraffle 7.11.3 
    <dc:date>2019-09-13 01:34:14 +0000</dc:date>
  </metadata>
  <g id="版面__" fill="none" fill-opacity="1" stroke-opacity="1" stroke="none" stroke-dasharray="none">
    <title>数据流</title>
    <g id="版面__: multi-gRPC-nodes-plan1">
      <title>multi-gRPC-nodes-plan1</title>
      <g id="Graphic_403">
        <rect x="-798" y="819" width="160" height="77.00001" fill="#ffff80"/>
        <rect x="-798" y="819" width="160" height="77.00001" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(-793 830.052)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" font-weight="400" fill="black" x=".184" y="15">gRPC-server-Node1:</tspan>
          <tspan font-family="Helvetica Neue" font-size="16" font-weight="400" fill="#b34400" x="34.096" y="51.448">SrvId: 0001</tspan>
        </text>
      </g>
      <g id="Graphic_404">
        <rect x="-798" y="959" width="160" height="77.00001" fill="#ffff80"/>
        <rect x="-798" y="959" width="160" height="77.00001" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(-793 970.052)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" font-weight="400" fill="black" x=".184" y="15">gRPC-server-Node2:</tspan>
          <tspan font-family="Helvetica Neue" font-size="16" font-weight="400" fill="#b1001c" x="31.872" y="51.448">Srved: 0002</tspan>
        </text>
      </g>
      <g id="Graphic_405">
        <rect x="-798" y="1099" width="160" height="77.00001" fill="#ffff80"/>
        <rect x="-798" y="1099" width="160" height="77.00001" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(-793 1110.052)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" font-weight="400" fill="black" x=".184" y="15">gRPC-server-Node3:</tspan>
          <tspan font-family="Helvetica Neue" font-size="16" font-weight="400" fill="#b1001c" x="34.096" y="51.448">SrvId: 0003</tspan>
        </text>
      </g>
      <g id="Graphic_408">
        <rect x="-798" y="1254" width="160" height="77.00001" fill="#ffff80"/>
        <rect x="-798" y="1254" width="160" height="77.00001" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(-793 1255.828)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" font-weight="400" fill="black" x="26.264" y="15">gRPC-server-</tspan>
          <tspan font-family="Helvetica Neue" font-size="16" font-weight="400" fill="black" x="47.592" y="33.448">NodeN:</tspan>
          <tspan font-family="Helvetica Neue" font-size="16" font-weight="400" fill="#b1001c" x="26.56" y="69.896">SrvId: XXXXN</tspan>
        </text>
      </g>
      <g id="Graphic_409">
        <text transform="translate(-729 1174)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="22" font-weight="400" fill="black" x="0" y="21">…</tspan>
        </text>
      </g>
      <g id="Graphic_410">
        <path d="M -1097.4904 1085.4452 C -1127.875 1079 -1115.7584 1024.742 -1067.2882 1034 C -1062.7913 1015.9532 -1006.427 1018.8824 -1006.7955 1034 C -971.4534 1014.6644 -926.2882 1053.2192 -956.5826 1072.5548 C -920.2309 1081.9292 -957.0413 1132.4372 -986.875 1124 C -989.2626 1138.0628 -1042.5963 1142.984 -1047.2775 1124 C -1077.4778 1144.274 -1140.4503 1113.1016 -1097.4904 1085.4452 Z" fill="#ffc0ff"/>
        <path d="M -1097.4904 1085.4452 C -1127.875 1079 -1115.7584 1024.742 -1067.2882 1034 C -1062.7913 1015.9532 -1006.427 1018.8824 -1006.7955 1034 C -971.4534 1014.6644 -926.2882 1053.2192 -956.5826 1072.5548 C -920.2309 1081.9292 -957.0413 1132.4372 -986.875 1124 C -989.2626 1138.0628 -1042.5963 1142.984 -1047.2775 1124 C -1077.4778 1144.274 -1140.4503 1113.1016 -1097.4904 1085.4452 Z" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(-1088.8 1069.776)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" font-weight="400" fill="black" x="7.447999" y="15">LB or Lookupd</tspan>
        </text>
      </g>
      <g id="Line_411">
        <path d="M -807.9 857.5 L -812.9 857.5 L -901.3597 857.619 L -1028 857.619 L -1028 1022.0902" marker-start="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Line_412">
        <path d="M -807.9 997.5 L -871.6539 997.5 L -871.6539 1079 L -945.0722 1079" marker-start="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Line_413">
        <path d="M -807.9 1137.5 L -871.6656 1137.5 L -871.6656 1079.4469 L -935.3078 1079 L -945.0722 1079" marker-start="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Line_414">
        <path d="M -807.9 1292.5 L -1028.0703 1292.5 L -1028.0703 1291.8561 L -1028 1145.8913 L -1028 1135.8907" marker-start="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_415">
        <rect x="-963.2661" y="844.119" width="94.83268" height="27" fill="white"/>
        <text transform="translate(-958.2661 849.119)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x=".8543399" y="13">RPC  request 1</tspan>
        </text>
      </g>
      <g id="Graphic_416">
        <rect x="-980.4672" y="1279" width="91.252" height="27" fill="white"/>
        <text transform="translate(-975.4672 1284)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="19895197e-20" y="13">RPC Request2</tspan>
        </text>
      </g>
      <g id="Graphic_417">
        <rect x="-915.4139" y="1029.9863" width="87.52" height="27" fill="white"/>
        <text transform="translate(-910.4139 1034.9863)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="21316282e-20" y="13">RPC request4</tspan>
        </text>
      </g>
      <g id="Graphic_418">
        <rect x="-909.76" y="1092" width="87.52" height="27" fill="white"/>
        <text transform="translate(-904.76 1097)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="21316282e-20" y="13">RPC request3</tspan>
        </text>
      </g>
      <g id="Graphic_419">
        <path d="M -427.49044 1076.4452 C -457.875 1070 -445.7584 1015.742 -397.28824 1025 C -392.7913 1006.9532 -336.427 1009.8824 -336.7955 1025 C -301.45336 1005.6644 -256.28824 1044.2192 -286.58256 1063.5548 C -250.23088 1072.9292 -287.04128 1123.4372 -316.875 1115 C -319.2626 1129.0628 -372.5963 1133.984 -377.2775 1115 C -407.47784 1135.274 -470.4503 1104.1016 -427.49044 1076.4452 Z" fill="#c0ffff"/>
        <path d="M -427.49044 1076.4452 C -457.875 1070 -445.7584 1015.742 -397.28824 1025 C -392.7913 1006.9532 -336.427 1009.8824 -336.7955 1025 C -301.45336 1005.6644 -256.28824 1044.2192 -286.58256 1063.5548 C -250.23088 1072.9292 -287.04128 1123.4372 -316.875 1115 C -319.2626 1129.0628 -372.5963 1133.984 -377.2775 1115 C -407.47784 1135.274 -470.4503 1104.1016 -427.49044 1076.4452 Z" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(-418.8 1040.552)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="16" font-weight="400" fill="black" x="6.863999" y="15">Redis Pub/Sub</tspan>
          <tspan font-family="PingFang SC" font-size="16" font-weight="400" fill="black" x="53.192" y="35.448">or </tspan>
          <tspan font-family="Helvetica Neue" font-size="16" font-weight="400" fill="black" x="47.752" y="55.448">MQ</tspan>
        </text>
      </g>
      <g id="Line_420">
        <line x1="-644.2509" y1="901.0324" x2="-436.31804" y2="1023.7706" marker-end="url(#FilledArrow_Marker_2)" marker-start="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Line_421">
        <path d="M -628.2994 1015.7822 L -549.4174 1031.8595 L -453.6529 1050.9409" marker-end="url(#FilledArrow_Marker_2)" marker-start="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Line_422">
        <line x1="-628.2696" y1="1120.6755" x2="-447.1515" y2="1086.7159" marker-end="url(#FilledArrow_Marker_2)" marker-start="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Line_423">
        <line x1="-647.2865" y1="1248.7951" x2="-437.67503" y2="1119.2436" marker-end="url(#FilledArrow_Marker_2)" marker-start="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_424">
        <rect x="-599.6781" y="948.0459" width="115.888" height="27" fill="white"/>
        <text transform="translate(-594.6781 953.0459)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="0" y="13">Pub req1 if not self</tspan>
        </text>
      </g>
      <g id="Graphic_425">
        <rect x="-611.2543" y="1017.8094" width="118.276" height="27" fill="white"/>
        <text transform="translate(-606.2543 1022.8094)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="8384404e-19" y="13">Pub req4 if not self</tspan>
        </text>
      </g>
      <g id="Graphic_426">
        <rect x="-601.6902" y="1091.1035" width="118.276" height="27" fill="white"/>
        <text transform="translate(-596.6902 1096.1035)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="8384404e-19" y="13">Pub req3 if not self</tspan>
        </text>
      </g>
      <g id="Graphic_427">
        <rect x="-596.3337" y="1167.2529" width="118.276" height="27" fill="white"/>
        <text transform="translate(-591.3337 1172.2529)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="8384404e-19" y="13">Pub req2 if not self</tspan>
        </text>
      </g>
      <g id="Graphic_429">
        <rect x="-596.3337" y="1194.2529" width="69.748" height="27" fill="white"/>
        <text transform="translate(-591.3337 1199.2529)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="0" y="13">Sub all req</tspan>
        </text>
      </g>
      <g id="Graphic_430">
        <rect x="-601.6902" y="1118.1035" width="69.748" height="27" fill="white"/>
        <text transform="translate(-596.6902 1123.1035)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="0" y="13">Sub all req</tspan>
        </text>
      </g>
      <g id="Graphic_431">
        <rect x="-611.2543" y="1044.8094" width="69.748" height="27" fill="white"/>
        <text transform="translate(-606.2543 1049.8094)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="0" y="13">Sub all req</tspan>
        </text>
      </g>
      <g id="Graphic_432">
        <rect x="-599.6781" y="971.6113" width="69.748" height="27" fill="white"/>
        <text transform="translate(-594.6781 976.6113)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="0" y="13">Sub all req</tspan>
        </text>
      </g>
      <g id="Graphic_433" filter="url(#Shadow)">
        <path d="M -1371 1019 L -1313.9366 1060.459 L -1335.7328 1127.541 L -1406.2672 1127.541 L -1428.0634 1060.459 Z" fill="#c0ffff"/>
        <path d="M -1371 1019 L -1313.9366 1060.459 L -1335.7328 1127.541 L -1406.2672 1127.541 L -1428.0634 1060.459 Z" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(-1426 1072)" fill="black">
          <tspan font-family="Helvetica" font-size="12" font-weight="400" fill="black" x="26.32715" y="11">RPC-client</tspan>
        </text>
      </g>
      <g id="Line_434">
        <line x1="-1319.961" y1="1079" x2="-1118.8564" y2="1079" marker-end="url(#FilledArrow_Marker_2)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_435">
        <text transform="translate(-1426 1384.384)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="0" y="13">优点：</tspan>
          <tspan font-family="Helvetica Neue" font-size="12" font-weight="400" fill="black" y="13"> </tspan>
          <tspan font-family="Helvetica Neue" font-size="12" font-weight="400" fill="black" x="0" y="30">1. </tspan>
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" y="30">简单暴力，减轻心智负担</tspan>
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="0" y="47">2. RPC 调用少的情况下对系统无压力，资源轻度浪费</tspan>
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="0" y="64">3. 支持在此基础上扩展：如需要同步更新Node中的配置数据</tspan>
        </text>
      </g>
      <g id="Graphic_436">
        <text transform="translate(-1084 1384.384)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="0" y="13">缺点：</tspan>
          <tspan font-family="Helvetica Neue" font-size="12" font-weight="400" fill="black" y="13"> </tspan>
          <tspan font-family="Helvetica Neue" font-size="12" font-weight="400" fill="black" x="0" y="30">1. </tspan>
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" y="30">需要一个LB或者Lookupd, 否则对客户端不友好</tspan>
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="0" y="47">2. RPC 调用多的情况下, 每条消息都要被所有node消费，存在不必要的消耗</tspan>
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="0" y="64">3. 需要依赖Redis或者MQ</tspan>
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="0" y="81">4. 节点需要增加publish 逻辑和 subscribe 逻辑</tspan>
        </text>
      </g>
      <g id="Graphic_470">
        <rect x="-1257.2579" y="1065.5" width="50" height="27" fill="white"/>
        <text transform="translate(-1252.2579 1070.5)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="9.098" y="13">Req</tspan>
        </text>
      </g>
    </g>
  </g>
</svg>
